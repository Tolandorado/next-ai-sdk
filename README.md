# ChatGPT Lite — Excel Assistant

Chat GPT Lite с custom tools для EXcel. Проект позволяет общаться с AI, который умеет читать, анализировать и редактировать данные в XLSX-файлах с использованием механизма Tool Calling.

## Стек технологий

- **Framework:** Next.js 16 (App Router, TypeScript)
- **Runtime & DB:** Bun + `bun:sqlite` (автоматическая инициализация при запуске)
- **AI Integration:** Vercel AI SDK (`ai`, `@ai-sdk/openai`)
- **Styling:** Tailwind CSS 4
- **Excel Logic:** `xlsx` (SheetJS) для парсинга и записи файлов

## Подготовка окружения

1. Установите **Bun** (инструкции на bun.sh).
2. В корневой директории проекта создайте папку `data`, если она еще не существует, добавьте в нее excel файл с таблицей.
3. Перейдите в директорию фронтенда:
   ```bash
   cd frontend
   ```
4. Настройте переменные окружения. Создайте файл `.env` на основе env.example:
   ```bash
   cp env.example .env
   ```

### Переменные окружения:
- `OPENAI_API_KEY`: Ваш ключ OpenAI API.
- `DATABASE_PATH`: Путь к файлу базы данных SQLite (по умолчанию `./data/chat.db`).
- `XLSX_FILE_PATH`: Путь к рабочему Excel-файлу (по умолчанию `./data/example.xlsx`).
- `NEXT_PUBLIC_DEFAULT_SHEET`: Лист по умолчанию (например, `Sheet1`).
- `NEXT_PUBLIC_DEFAULT_FROM` / `NEXT_PUBLIC_DEFAULT_TO`: Диапазон для начального отображения (например, `A1` / `C3`).

## Запуск

```bash
bun install
bun --bun run dev
```
Приложение будет доступно по адресу `http://localhost:3000`. База данных и необходимые папки будут созданы автоматически при первом обращении.

## Основные возможности

*   **Чат с ИИ-помощником**: Интерактивный чат с возможностью создания и управления несколькими тредами.
*   **Работа с XLSX-файлами**: Функциональность для взаимодействия с данными в формате Excel, включая:
    *   Обновление диапазонов ячеек.
    *   Изменение отдельных ячеек.
    *   Подтверждение операций через модальные окна.
    *   Объяснение формул и выражений в ячейках.
*   **Отображение и управление данными**: Представление данных в табличном виде с возможностью интерактивного взаимодействия.
*   **API-интерфейсы**: Набор API для управления чатом, сообщениями, тредами и операциями с XLSX.